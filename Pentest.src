//pentest
xploit = include_lib("metaxploit")

file = "/bin/" + params[0]
text = get_shell.host_computer.File(file).content
text1 = text.replace("<b>","#")
text2 = text1.replace("</b>","#")
text3 = text2.replace(".")
text4 = text3.replace("\n")
text5 = text4.replace("*")
text6 = text5.replace("Unsafe")
text7 = text6.split(" ")
exploits = ""
for line in text7
	if line.code == 35 then
		buffer = line.replace("#")
		buff_value = buffer.values
		value = 0 
		for i in buff_value
			value = value + i.code
		end for
		if value != 165 then
			if value != 1608 then
				if value != 155 then
					exploits = exploits + buffer + " "
				end if
			end if
		end if
	end if
end for
list = exploits.split(" ")
board = ""
for buff in list
	if buff != "" then
		service = xploit.net_use(params[1],params[2].to_int)
		if not service then exit("cannot attemp host")
		dumps = service.dump_libs
		if buff != "netso" and buff != "initso" then result = dumps.overflow(params[0],buff,"buffed")
		if buff != "netso" and buff != "initso" then board = board + buff + " " + typeof(result) + "\n"
	end if
end for
board = "<b>\n" + board + "</b>"
print(format_columns(board))
